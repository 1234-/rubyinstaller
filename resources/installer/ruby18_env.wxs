<?xml version="1.0" encoding="utf-8"?>
<?include config.wxi ?>
<Wix xmlns="http://schemas.microsoft.com/wix/2003/01/wi">
  <Fragment>
    <ComponentGroup Id="group_RUBY_ENV">
      <ComponentRef Id="comp_RUBY_PATH" />
      <ComponentRef Id="comp_RUBYGEMS_SHORTCUTS" />
      <ComponentRef Id="comp_RUBY_SHORTCUTS" />
    </ComponentGroup>
    <DirectoryRef Id="TARGETDIR">
      <Directory Id="ProgramMenuFolder">
        <Directory Id="ShortcutFolder" Name="RUBY_18" LongName="$(var.ProductName)">
          <Directory Id="RubyGemsShortcutFolder" Name="RB_GEM18" LongName="RubyGems $(var.RubyGemsVersion)">
            <Component Id="comp_RUBYGEMS_SHORTCUTS" Guid="5A8FB651-CA54-4ECB-A162-FD2B91BA32F2">
              <RemoveFolder Id="RemoveShortcutRubyGemsFolder" On="uninstall" />
              <Shortcut Id="RubyGemsServer" Directory="RubyGemsShortcutFolder" Name="GEMSERVE" LongName="Start RubyGems RDoc Server" Description="Start RubyGems RDoc Server" Target="[INSTALLDIR]bin\gem.bat" Arguments="server" Icon="RubyInstallerIcon" />
              <Shortcut Id="RubyGemsConsole" Directory="RubyGemsShortcutFolder" Name="GEM_CMD" LongName="RubyGems Package Manager" Description="RubyGems Package Manager Console" Target="[System64Folder]cmd.exe" Arguments="/k [INSTALLDIR]bin\gem.bat" />
            </Component>
          </Directory>
          <Component Id="comp_RUBY_SHORTCUTS" Guid="685A7A49-09FF-43ae-ABF7-237095251F4B">
            <RemoveFolder Id="RemoveShortcutFolder" On="uninstall" />
            <Shortcut Id="InteractiveConsole" Name="IRB" LongName="irb - Interactive Ruby Console" Target="[INSTALLDIR]bin\irb.bat" Directory="ShortcutFolder" Description="Start a Ruby Interactive Console (irb)" Icon="RubyInstallerIcon" />
            <Shortcut Id="UninstallProduct" Name="UN_RUBY" LongName="Uninstall $(var.ProductName)" Target="[System64Folder]msiexec.exe" Arguments="/x [ProductCode]" Directory="ShortcutFolder" Description="Uninstalls $(var.ProductName)" />
          </Component>
        </Directory>
      </Directory>
      <Component Id="comp_RUBY_PATH" Guid="4E193F84-0D60-45c9-932F-91919C7B95C0">
        <Environment Id="Environment" Name="PATH" Action="set" Part="last" System="yes" Value="[INSTALLDIR]bin" />
      </Component>
    </DirectoryRef>
  </Fragment>
</Wix>
